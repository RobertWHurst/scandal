{"name":"scandal","tagline":"Efficient directory scan + search utilities","body":"# scandal - Scandalous directory scanning and searching\r\n\r\n[![Build Status](https://travis-ci.org/atom/scandal.png)](https://travis-ci.org/atom/scandal)\r\n\r\nscandal provides two utilities:\r\n\r\n* Scanning a directory for paths matching a set of glob inclusions or exclusions. For example, you want to find a list of paths to search that match a certain pattern, but are not ignored by the `.gitignore`.\r\n\r\n* Searching a list of paths for a regex. For example, you have a list of paths, you want to find all instances of `/text/gi`.\r\n\r\nUnsurprisingly, these two things can be combined to scan and search a directory.\r\n\r\n## Goals\r\n\r\nIt is written to be simple, flexible and efficient. Scandal does the minimum.\r\n\r\nWe want to provide modules to combine in any way you'd like. Want to scan in one process and search in another? You can do that.\r\n\r\nTo be clear, scandal is not a CLI. It can be used from the terminal, but in practice it's only used for benchmarking.\r\n\r\n## Objects\r\n\r\nscandal provides two main modules: `PathScanner` and `PathSearcher`.\r\n\r\n### PathScanner\r\n\r\nUsage is simple:\r\n\r\n```coffeescript\r\n{PathScanner} = require 'scandal'\r\nscanner = new PathScanner('/Users/me/myDopeProject', options)\r\n\r\nscanner.on 'path-found', (path) ->\r\n  console.log(path)\r\n\r\nscanner.on 'finished-scanning', ->\r\n  console.log('All done!')\r\n\r\nscanner.scan()\r\n```\r\n\r\n`PathScanner` keeps no state. You must consume paths via the 'path-found' event.\r\n\r\n#### options\r\n\r\n* _excludeVcsIgnores_ - bool; default false; true to exclude paths defined in a .gitignore. Uses [git-utils](http://atom.github.io/node-git/) to check ignred files.\r\n* _inclusions_ - list of patterns to include. Uses [minimatch](https://github.com/isaacs/minimatch) with a couple additions: `['dirname']` and `['dirname/']` will match all paths in direcotry `dirname`\r\n* _exclusions_ - list of patterns to exclude. Same matcher as `inclusions`.\r\n* _includeHidden_ - bool; default false; true includes hidden files.\r\n\r\n### PathSearcher\r\n\r\n```coffeescript\r\n{PathSearcher} = require 'scandal'\r\nsearcher = new PathSearcher()\r\n\r\n# You can subscribe to a `results-found` event\r\nsearcher.on 'results-found', (result) ->\r\n  # result will contain all the matches for a single path\r\n  console.log(\"Single Path's Results\", result)\r\n\r\n# Search a list of paths\r\nsearcher.searchPaths /text/gi, ['/Some/path', ...], (results) ->\r\n  console.log('Done Searching', results)\r\n\r\n# Search a single path\r\nsearcher.searchPath /text/gi, '/Some/path', (result) ->\r\n  console.log('Done Searching', result)\r\n```\r\n\r\nResults from line 10 (1 based) are in the following format.\r\n\r\n```json\r\n{\r\n  \"path\": \"/Some/path\",\r\n  \"matches\": {\r\n    \"matchText\": \"Text\",\r\n    \"lineText\": \"Text in this file!\",\r\n    \"lineTextOffset\": 0,\r\n    \"range\": [[9, 0], [9, 4]]\r\n  }\r\n}\r\n```\r\n\r\nLike the `PathScanner` the searcher keeps no state. You need to consume results via the done callbacks or event.\r\n\r\nFile reading is fast and memory efficient. It reads in 10k chunks and writes over each previous chunk. Small object creation is kept to a minimum during the read to make light use of the GC.\r\n\r\n### PathFilter\r\n\r\nA third object, `PathFilter` is available, but intended for use by the `PathScanner`.\r\n\r\n## Using the scanner and searcher together\r\n\r\nIf you dont want to think about combining the `PathScanner` and `PathSearcher` in your own way, a `search` is function provided.\r\n\r\n```coffeescript\r\n{search, PathScanner, PathSearcher} = require 'scandal'\r\n\r\npath = '/path/to/search'\r\nscanner = new PathScanner(path, excludeVcsIgnores: true)\r\nsearcher = new PathSearcher()\r\n\r\nsearcher.on 'results-found' (result) ->\r\n  # do something rad with the result!\r\n\r\nname = \"Search #{path}\"\r\nconsole.time name\r\nconsole.log name\r\nsearch /text/ig, scanner, searcher, ->\r\n  console.timeEnd name\r\n```\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}